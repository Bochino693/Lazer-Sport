<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Endere√ßo de Entrega</title>

    <style>
        /* ===== RESET / BASE ===== */
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f7fb;
            color: #212529;
        }

        /* ===== BREADCRUMB ===== */
        .breadcrumb-strong {
            padding: 16px;
            font-size: 0.85rem;
            font-weight: 800;
            color: #6c757d;
        }

        .breadcrumb-strong a {
            color: #0d6efd;
            text-decoration: none;
        }

        .breadcrumb-strong span {
            margin: 0 6px;
        }

        /* ===== CONTAINER ===== */
        .container {
            padding: 20px;
        }

        h1 {
            margin: 0 0 20px;
            font-size: 1.35rem;
            font-weight: 900;
            color: #0d6efd;
        }

        /* ===== FORM ===== */
        .form-group {
            margin-bottom: 14px;
        }

        label {
            font-size: 0.8rem;
            font-weight: 700;
            margin-bottom: 4px;
            display: block;
            color: #495057;
        }

        input {
            width: 100%;
            padding: 14px;
            border-radius: 14px;
            border: 1px solid #dee2e6;
            font-size: 1rem;
        }

        input::placeholder {
            color: #adb5bd;
            font-weight: 500;
        }

        input:disabled {
            background: #f1f3f5;
            color: #868e96;
        }

        .erro {
            font-size: 0.75rem;
            color: #dc3545;
            margin-top: 4px;
            display: none;
        }

        /* ===== BOT√ÉO ===== */
        button {
            width: 100%;
            padding: 16px;
            margin-top: 10px;
            border: none;
            border-radius: 30px;
            background: linear-gradient(135deg, #198754, #28a745);
            color: #fff;
            font-size: 1.05rem;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(40, 167, 69, .35);
        }

        button:disabled {
            background: #adb5bd;
            box-shadow: none;
        }

        /* ===== DESKTOP ===== */
        @media (min-width: 768px) {
            body {
                background: linear-gradient(180deg, #f5f7fb, #eef1f6);
            }

            .container {
                max-width: 600px;
                margin: 40px auto;
                background: #fff;
                padding: 28px;
                border-radius: 22px;
                box-shadow: 0 20px 50px rgba(0,0,0,.08);
            }

            h1 {
                font-size: 1.6rem;
            }
        }

        /* ===== FORM ===== */
form {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.form-group {
    width: 100%;
    margin-bottom: 12px;
}

.form-row {
    display: flex;
    gap: 10px;
    width: 100%;
}

/* labels mais compactos */
label {
    font-size: 0.75rem;
    font-weight: 700;
    margin-bottom: 4px;
    display: block;
}

/* inputs base */
input {
    width: 100%;
    padding: 10px 12px;
    border-radius: 12px;
    border: 1px solid #dee2e6;
    font-size: 0.9rem;
}

/* tamanhos */
.input-sm {
    padding: 8px 10px;
    font-size: 0.85rem;
}

.input-md {
    padding: 10px 12px;
}

.input-lg {
    padding: 12px 14px;
    font-size: 0.95rem;
}

/* campos espec√≠ficos */
.input-cep {
    max-width: 180px;
}

.input-numero {
    max-width: 120px;
}

.input-uf {
    max-width: 80px;
    text-transform: uppercase;
    text-align: center;
}

/* bot√£o */
button {
    margin-top: 16px;
    max-width: 320px;
}


    </style>
</head>

<body>

    <div class="breadcrumb-strong">
        <a href="#">Carrinho</a>
        <span>‚Ä∫</span>
        <strong>Endere√ßo & Entrega</strong>
    </div>

   <div class="container">
    <h1 style="text-align:center;">üì¶ Endere√ßo de Entrega</h1>

    <form method="post">
        {% csrf_token %}

        <!-- CEP -->
        <div class="form-group" style="display:flex; justify-content:center;">
            <div>
                <label>CEP</label>
                <input
                    type="text"
                    name="cep"
                    id="cep"
                    class="input-md input-cep"
                    maxlength="9"
                    placeholder="12345-678"
                    inputmode="numeric"
                >
                <div class="erro" id="erroCep">CEP inv√°lido ou n√£o encontrado</div>
            </div>
        </div>

        <!-- Telefone -->
        <div class="form-group" style="display:flex; justify-content:center;">
            <div>
                <label>Telefone para contato</label>
                <input
                    type="tel"
                    name="telefone"
                    id="telefone"
                    class="input-md input-cep"
                    placeholder="(11) 91234-5678"
                    inputmode="tel"
                >
            </div>
        </div>




        <!-- Rua -->
        <div class="form-group">
            <label>Rua</label>
            <input
                type="text"
                name="rua"
                id="rua"
                class="input-lg"
                placeholder="Nome da rua"
            >
        </div>

        <!-- N√∫mero + Complemento -->
        <div class="form-row">
            <div class="form-group">
                <label>N√∫mero</label>
                <input
                    type="text"
                    name="numero"
                    id="numero"
                    class="input-sm input-numero"
                    placeholder="N¬∫"
                >
            </div>

            <div class="form-group">
                <label>Complemento</label>
                <input
                    type="text"
                    name="complemento"
                    id="complemento"
                    class="input-md"
                    placeholder="Apto, bloco..."
                >
            </div>
        </div>

        <!-- Bairro -->
        <div class="form-group">
            <label>Bairro</label>
            <input
                type="text"
                name="bairro"
                id="bairro"
                class="input-md"
                placeholder="Bairro"
            >
        </div>

        <!-- Cidade + Estado -->
        <div class="form-row">
            <div class="form-group">
                <label>Cidade</label>
                <input
                    type="text"
                    name="cidade"
                    id="cidade"
                    class="input-md"
                    placeholder="Cidade"
                >
            </div>

            <div class="form-group">
                <label>UF</label>
                <input
                    type="text"
                    name="estado"
                    id="estado"
                    class="input-sm input-uf"
                    maxlength="2"
                    placeholder="UF"
                >
            </div>
        </div>

        <button type="submit" id="btnContinuar" disabled>
            Continuar para pagamento
        </button>
    </form>
</div>

    <script>
        const cepInput = document.getElementById('cep');
        const erroCep = document.getElementById('erroCep');
        const btn = document.getElementById('btnContinuar');
        const telefoneInput = document.getElementById('telefone');

    telefoneInput.addEventListener('input', () => {
        let v = telefoneInput.value.replace(/\D/g, '');

        if (v.length <= 10) {
            telefoneInput.value = v
                .replace(/^(\d{2})(\d)/, '($1) $2')
                .replace(/(\d{4})(\d)/, '$1-$2')
                .slice(0, 14);
        } else {
            telefoneInput.value = v
                .replace(/^(\d{2})(\d)/, '($1) $2')
                .replace(/(\d{5})(\d)/, '$1-$2')
                .slice(0, 15);
        }
    });

        const campos = ['telefone', 'rua', 'numero', 'complemento', 'bairro', 'cidade', 'estado'];

        function bloquearCampos(bloquear = true) {
            campos.forEach(id => {
                const campo = document.getElementById(id);
                campo.disabled = bloquear;
                if (bloquear) campo.value = '';
            });
            btn.disabled = bloquear;
        }

        function formatarCep(valor) {
            return valor
                .replace(/\D/g, '')
                .replace(/^(\d{5})(\d)/, '$1-$2')
                .slice(0, 9);
        }

        function resetarFormulario() {
            erroCep.style.display = 'none';
            bloquearCampos(true);
        }

        function consultarCep(cep) {
            fetch(`https://viacep.com.br/ws/${cep}/json/`)
                .then(res => res.json())
                .then(data => {
                    if (data.erro) {
                        erroCep.style.display = 'block';
                        bloquearCampos(true);
                        return;
                    }

                    erroCep.style.display = 'none';
                    bloquearCampos(false);

                    rua.value = data.logradouro || '';
                    bairro.value = data.bairro || '';
                    cidade.value = data.localidade || '';
                    estado.value = data.uf || '';
                })
                .catch(() => {
                    erroCep.style.display = 'block';
                    bloquearCampos(true);
                });
        }

        cepInput.addEventListener('input', () => {
            cepInput.value = formatarCep(cepInput.value);
            const cepLimpo = cepInput.value.replace(/\D/g, '');

            if (cepLimpo.length < 8) {
                resetarFormulario();
                return;
            }

            if (cepLimpo.length === 8) {
                consultarCep(cepLimpo);
            }
        });

        resetarFormulario();
    </script>

</body>
</html>
